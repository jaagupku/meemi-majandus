var SPLITPATHNAME=location.pathname.split("/");var FROM=SPLITPATHNAME.length>2?parseInt(SPLITPATHNAME[2]):0;var XLST="";var LOADBUTTON=$("#load-button");var lang=$("html").attr("lang");$(function(){loadVoting("meme-container","meme");$(document).on("click tap",".not-loaded-video a",function(a){a.preventDefault()});$(document).on("click tap",".not-loaded-video",function(){var a=$(this);var b=$('<iframe class="embed-responsive-item" allowfullscreen></iframe>');b.attr("src","https://www.youtube.com/embed/"+a.attr("data-id")+"?autoplay=1");ga("send",{hitType:"event",eventCategory:"Video",eventAction:"play",eventLabel:a.attr("data-id")});a.removeClass("not-loaded-video");a.html(b)});if(LOADBUTTON.length===0){return}$.ajax({method:"GET",url:location.protocol+"//"+location.hostname+"/assets/xlst/meme_"+lang+".xsl",dataType:"xml"}).done(function(a){XLST=a;window.onscroll=yHandler});LOADBUTTON.text(LOADBUTTON.attr("data-text-loading"))});function yHandler(){var a=document.getElementById("memebody");var b=a.offsetHeight;var c=window.pageYOffset+window.innerHeight;if(c+400>=b){window.onscroll=null;if($(".meme").length<50){loadMore()}else{LOADBUTTON.text(LOADBUTTON.attr("data-text-morespice"))}}}function addFromXML(f,c,a,d){var e=jQuery.parseXML(f);var b=new XSLTProcessor();b.importStylesheet(c);$(a)[d](b.transformToFragment(e,document))}function loadMore(){var d=LOADBUTTON.attr("data-load-from");var a=LOADBUTTON.attr("data-load-amount");var b=LOADBUTTON.attr("data-load-type");var c="type="+b+"&from="+d+"&amount="+a;$.ajax({method:"GET",url:location.protocol+"//"+location.hostname+"/main/getMemesXML?"+c,error:function(g,e,f){$("#load-button").hide()}}).done(function(e){if(e==="null"){window.onscroll=null;LOADBUTTON.hide();$("#memebody").append('<div class="container-fluid"><div class="row col-centered col-custom-frontpage"><p>'+LOADBUTTON.attr("data-text-reachedend")+"</p></div></div>")}else{addFromXML(e,XLST,"#load-more","append");var f=parseInt(d)+parseInt(a);LOADBUTTON.attr("data-load-from",f);LOADBUTTON.attr("href","/"+b+"?from"+f+"&amount="+a);window.onscroll=yHandler;var g=$(".meme").length;history.replaceState({},"","/"+b+"?from="+FROM+"?amount="+g)}})};